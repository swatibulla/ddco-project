<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Decode & Discover — 15 Puzzles</title>
<style>
  :root{
    --bg1:#0b1220;
    --bg2:#071020;
    --electric:#00b3ff;
    --accent:#00aaff;
    --panel: rgba(0,0,0,0.82);
    --input-bg: rgba(0,51,102,0.92);
    --hint: #ffda79;
    --text: #e6f7ff;
  }
  html,body{height:100%;margin:0}
  body{
    background: linear-gradient(180deg,var(--bg1),var(--bg2));
    color:var(--text);
    font-family: "Inter", Arial, sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:28px;
    box-sizing:border-box;
  }
  h1{
    margin:6px 0 12px 0;
    color:var(--electric);
    font-size:34px;
    letter-spacing:1px;
    text-shadow: 0 0 12px rgba(0,179,255,0.25);
    font-weight:700;
  }
  #instructions{
    width:820px;
    max-width:94%;
    background:var(--panel);
    border:2px solid var(--accent);
    padding:14px 18px;
    border-radius:12px;
    text-align:left;
    line-height:1.4;
    margin-bottom:14px;
  }

  #doorCounter{
    color: var(--hint);
    font-weight:600;
    margin-bottom:12px;
  }
  #questionBox{
    width:820px;
    max-width:94%;
    background: linear-gradient(180deg, rgba(0,0,0,0.62), rgba(6,12,20,0.6));
    border-radius:12px;
    border:2px solid rgba(0,163,255,0.15);
    padding:22px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    text-align:left;
    color:var(--text);
    font-size:18px;
    margin-bottom:12px;
    display:none;
  }
  #questionText{ font-size:20px; margin-bottom:12px; }
  #answerRow{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
  input#answer {
    flex:1 1 420px;
    padding:12px 14px;
    font-size:17px;
    border-radius:8px;
    border:2px solid var(--electric);
    background:var(--input-bg);
    color:var(--text);
  }
  button#submitBtn{
    padding:12px 18px;
    background: linear-gradient(90deg,var(--electric),#00f0a0);
    border:none;
    color:#002;
    font-weight:700;
    border-radius:8px;
    cursor:pointer;
  }
  button#startBtn{
    padding:12px 20px;
    background:var(--electric);
    border:none;
    color:#001;
    font-weight:700;
    border-radius:8px;
    cursor:pointer;
    margin-top:8px;
  }
  #feedback { margin-top:12px; color:var(--hint); min-height:26px; }
  .small { font-size:14px; color:#bfefff; opacity:0.9; }
  .muted { color:#9ac7df; font-size:13px }
  .correct-answer { color:#8fffb0; font-weight:700; }
  footer{ margin-top:16px; color:#9ac7df; font-size:13px; }
  @media (max-width:520px){
    h1{font-size:28px}
    #questionText{font-size:18px}
  }
</style>
</head>
<body>

<h1>DECODE & DISCOVER</h1>

<div id="instructions">
  <strong>How to play</strong><br>
  • There are <strong>15</strong> questions. Answer them one-by-one in order. <br>
  • You have <strong>3 attempts</strong> per question. After the 2nd wrong try you get a hint. After the 3rd wrong try the correct answer is shown and the game automatically moves to the next question.<br>
  • Answers are checked case-insensitively and punctuation/extra spaces are ignored.wd<br>
</div>

<div id="doorCounter">Doors Unlocked: 0 / 15</div>

<div id="questionBox">
  <div id="questionText"></div>
  <div id="answerRow">
    <input id="answer" autocomplete="off" placeholder="Type your answer here" />
    <button id="submitBtn">Submit</button>
  </div>
  <div id="feedback" aria-live="polite"></div>
  <div class="small muted" id="progress"></div>
</div>

<button id="startBtn">Start</button>

<footer>Made for your escape room — responsive, stable, zero skipping.</footer>

<script>
const puzzles = [
  { q: "1) NOT(OR(0,1,0)) = ?", a: ["0"], hint: "OR yields 1 if any input is 1." },
  { q: "2) Decimal value of 1011?", a: ["11"], hint: "Binary to decimal: 8+0+2+1." },
  { q: "3) A full adder has how many inputs?", a: ["3"], hint: "A, B and carry-in." },
  { q: "4) I open only when every switch is ON. What am I?", a: ["and"], hint: "All inputs must be 1." },
  { q: "5) If two inputs differ I output 1. Who am I?", a: ["xor"], hint: "Exclusive OR." },
  { q: "6) I speak only when both are silent. Who am I?", a: ["nor"], hint: "Opposite of OR." },
  { q: "7) Where do C programs begin or runs", a: ["main"], hint: "The entry function." },
  { q: "8) I call myself until the work is done. What is this?", a: ["recursion"], hint: "A function calling itself." },
  { q: "9) I end the program instantly. Which command? (C)", 
    a: ["exit0","exit(0)","exit 0","exit(0);","exit 0;"], 
    hint: "Common C exit forms: exit(0) or exit 0." },
  { q: "10) Conversion from one data type to another is called?", a: ["typecasting", "casting"], hint: "E.g., (int) or (float)." },
  { q: "11) Light as a feather, yet no man can hold me for long. What am I?", a: ["breath"], hint: "You breathe it." },
  { q: "12) The more of me there is, the less you see. What am I?", a: ["darkness"], hint: "Opposite of light." },
  { q: "13) Find the next number: 2, 6, 12, 20, ?", a: ["30"], hint: "This is n(n+1): next is 5·6 ." },
  { q: "14) Which language popularized the phrase “write once, run anywhere”?", a: ["java"], hint: "Runs on the JVM." },
  { q: "15) Magic square 3×3 using 1–9, all rows/cols/diagonals sum 15. Center number?", a: ["5"], hint: "Center of 3×3 magic square " }
];

let current = 0;
let attempts = 0;
let correctCount = 0;

const qBox = document.getElementById("questionBox");
const qText = document.getElementById("questionText");
const answerInput = document.getElementById("answer");
const submitBtn = document.getElementById("submitBtn");
const feedbackEl = document.getElementById("feedback");
const progressEl = document.getElementById("progress");
const startBtn = document.getElementById("startBtn");
const doorCounter = document.getElementById("doorCounter");

function normalizeAnswer(s){
  if(!s) return "";
  s = String(s).trim().toLowerCase();
  s = s.replace(/;$/,'').trim();
  s = s.replace(/\s+/g,' ');
  return s;
}

function canonicalForms(s){
  const norm = normalizeAnswer(s);
  const noSpaces = norm.replace(/\s+/g,'');
  const stripPunct = norm.replace(/[^a-z0-9\(\)]/g,'');
  return new Set([norm, noSpaces, stripPunct]);
}

function updateDoorCounter(){
  doorCounter.textContent = `Doors Unlocked: ${correctCount} / 15`;
}

function renderCurrent(){
  attempts = 0;
  feedbackEl.textContent = "";
  answerInput.value = "";
  answerInput.disabled = false;
  submitBtn.disabled = false;
  updateDoorCounter();

  if(current >= puzzles.length){
    endGame();
    return;
  }

  const p = puzzles[current];
  qBox.style.display = "block";
  qText.innerText = p.q;
  progressEl.innerText = `Question ${current+1} of 15`;
  setTimeout(()=> answerInput.focus(), 50);
}



function checkAnswer(){
  if(current >= puzzles.length) return;
  const raw = answerInput.value.trim();
  if(!raw) return;

  const userForms = canonicalForms(raw);
  const p = puzzles[current];

  const accepted = new Set();
  p.a.forEach(a=>{
    const af = normalizeAnswer(a);
    accepted.add(af);
    accepted.add(af.replace(/\s+/g,''));
    accepted.add(af.replace(/[^a-z0-9\(\)]/g,''));
  });

  let matched = false;
  for(const f of userForms){ if(accepted.has(f)){ matched = true; break; } }

  attempts++;

  if(matched){
    correctCount++;
    updateDoorCounter();
    feedbackEl.innerHTML = `<span class="correct-answer">✅ Correct.</span>`;
    answerInput.disabled = true;
    submitBtn.disabled = true;
    setTimeout(()=> { current++; renderCurrent(); }, 600);
    return;
  }

  if(attempts === 1){
    feedbackEl.innerHTML = "❌ Incorrect — try again.";
  } else if(attempts === 2){
    feedbackEl.innerHTML = "❌ Incorrect — Hint coming in 1 minute...";
    setTimeout(()=>{
      feedbackEl.innerHTML = `❌ Incorrect — <strong>Hint:</strong> ${p.hint}`;
    }, 60000);
  } else {
    feedbackEl.innerHTML = "❌ Incorrect — Answer coming in 1 minute...";
    answerInput.disabled = true;
    submitBtn.disabled = true;
    setTimeout(()=>{
      feedbackEl.innerHTML = `❌ Incorrect — Correct: <span class="correct-answer">${p.a[0]}</span>`;
      setTimeout(()=> { current++; renderCurrent(); }, 1200);
    }, 60000);
  }
}

function endGame(){
  answerInput.disabled = true;
  submitBtn.disabled = true;
  document.getElementById("answerRow").style.display = "none";

  const passed = correctCount >= 8 ? "PASS" : "FAIL";
  const color = passed === "PASS" ? "#00ffb0" : "#ff6e6e";

  let resultHTML = `<h2 style="color:${color};">${passed}</h2>
                     <div style="font-size:20px;">Score: <strong>${correctCount} / 15</strong></div>
                     <div style="margin-top:6px;color:#9ac7df;">Minimum required: 8</div>`;
  
  if(passed === "PASS"){
    resultHTML += `<div style="margin-top:20px;padding:16px;background:rgba(0,179,255,0.15);border:2px solid rgba(0,179,255,0.3);border-radius:8px;color:#e6f7ff;font-size:16px;line-height:1.6;">
                     Among all the Dr-marked chambers, find the one lifted one level above the dust. Doctor's initials guard the room, but the true keeper is a lady of sound.
                   </div>`;
  }
  
  qText.innerHTML = resultHTML;

  progressEl.textContent = "";
  feedbackEl.textContent = "";
}

startBtn.addEventListener("click", ()=>{
  startBtn.style.display = "none";
  renderCurrent();
});

submitBtn.addEventListener("click", checkAnswer);
answerInput.addEventListener("keydown", (e)=>{ if(e.key==="Enter") checkAnswer(); });
</script>
</body>
</html>
